"use strict";function ProgressBar(){this.enabled=!1,this.oncomplete="",this.onerror="",this.progress="",this.progressInterval=null,this.container="",this.element="",this.max=100,this.min=0,this.error=!1,this.errortime=5e3,this.loadtime=500,this.error_timeout=null,this.complete=!1,this.removeOnComplete=!0,this.current=0,this.visual=!1,this.method="html5"}ProgressBar.prototype.init=function(a){if(isHTMLElement(a))this.container=a,this.element=this.create();else if("object"==typeof a){var b=a;this.container="container"in b&&isHTMLElement(b.container)?b.container:"",this.oncomplete="oncomplete"in b&&"function"==typeof b.oncomplete?b.oncomplete:"",this.onerror="onerror"in b&&"function"==typeof b.onerror?b.onerror:"",this.progress="progress"in b&&"function"==typeof b.progress?b.progress:"";var c="max"in b?b.max:"maximum"in b?b.maximum:"",d="min"in b?b.min:"minimum"in b?b.minimum:"";""!==c&&this.setMaximum(c),""!==d&&this.setMinimum(d),""!==this.progress?(this.enabled=!0,null!==this.container&&this.create()):(new IMDebugger).pass("The Progress Bar was not supplied a valid progress definer")}},ProgressBar.prototype.create=function(){if(""!==this.container&&isHTMLElement(this.container)){var a=$('<progress class="progressbar" />')[0],b=!1;if(b="hasOwnProperty"in a&&a.hasOwnProperty("max")?!0:b,b=!b&&"hasAttribute"in a&&a.hasAttribute("max")?!0:b,!b&&"attributes"in a&&a.attributes.length>0)for(var c=0,d=a.attributes.length;d>c;c+=1){if("nodeName"in a.attributes[c]&&"max"===a.attributes[c].nodeName){b=!0;break}if(a.attributes.max){b=!0;break}}switch(b=!b&&"max"in a?!0:b,this.method=b?"html5":"html4",this.method){case"html4":a=$('<div class="progressbar"><div /></div>');break;case"html5":a=$(a),a.attr("max","100"),a.attr("value","0"),a=a[0]}$(this.container).append(a),this.element=$(this.container).find(".progressbar")[0],this.visual=!0}},ProgressBar.prototype.visualProgression=function(){if(this.visual){var a=this;switch(this.method){case"html5":$(this.element).attr("value",a.current);break;case"html4":$(this.element).find("div").css("width",a.current+"%").attr("title",a.current+"%")}}},ProgressBar.prototype.begin=function(){this.enabled&&(this.setProgressInterval(),this.setErrorTimeout())},ProgressBar.prototype.setProgressInterval=function(){var a=this;this.progressInterval=setInterval(function(){a.determineProgress()},a.loadtime)},ProgressBar.prototype.clearProgressInterval=function(){null!==this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)},ProgressBar.prototype.clean=function(){if(this.clearProgressInterval(),this.clearErrorTimeout(),this.visual&&""!==this.element&&null!==this.container){var a=this;$(a.element).remove()}},ProgressBar.prototype.setMaximum=function(a){return"number"==typeof a?""!==this.min?"number"==typeof this.min&&a>this.min?(this.max=a,!0):((new IMDebugger).pass("The maximum value is less or equal to the minimum value"),!1):(this.max=a,!0):((new IMDebugger).pass("The maximum value must be a number"),!1)},ProgressBar.prototype.setMinimum=function(a){return"number"==typeof a?""!==this.max?"number"==typeof this.max&&a<this.max?(this.min=a,!0):((new IMDebugger).pass("The minimum value is greater or equal to the maximum value"),!1):(this.min=a,!0):((new IMDebugger).pass("The minimum value must be a number"),!1)},ProgressBar.prototype.determineError=function(){this.error=!0,"function"==typeof this.onerror&&this.onerror(),this.clean(),(new IMDebugger).pass("Progress bar has encountered a timeout after "+this.errortime/1e3+" seconds, the error functionality has fired")},ProgressBar.prototype.determineProgress=function(){var a=this.progress();"number"==typeof a&&(a>=this.max?this.completed():(a=this.calculateProgress(a),a!==this.current&&this.clearErrorTimeout(),this.current=a,this.visualProgression(),a>=100?this.completed():null===this.error_timeout&&this.setErrorTimeout()))},ProgressBar.prototype.completed=function(){this.current=100,this.visualProgression(),this.complete=!0,this.clean(),"function"==typeof this.oncomplete&&this.oncomplete()},ProgressBar.prototype.calculateProgress=function(a){return Math.round((a-this.min)/(this.max-this.min)*100)},ProgressBar.prototype.setErrorTimeout=function(){this.clearErrorTimeout();{var a=this;a.current}this.error_timeout=setTimeout(function(){a.completed?(a.clean(),this.error=!1):(a.determineError(a.current),a.clean(),(new IMDebugger).pass("All Stop Error"))},a.errortime)},ProgressBar.prototype.clearErrorTimeout=function(){null!==this.error_timeout&&(clearTimeout(this.error_timeout),this.error_timeout=null)};